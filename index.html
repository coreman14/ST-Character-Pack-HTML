 <!DOCTYPE html>  <html lang="en">  <head>  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" >  <title>Class Swap Viewer</title>  <script src="https://code.jquery.com/jquery-3.5.0.js"></script>  <style>  body {  text-align: center;  }  #canvas{  padding-top: 10px;  }  .outerDiv{  position: relative;  text-align: center;  }  .characterswrap{  display: flex;  flex-wrap: wrap;  justify-content: center; /* here we just put the only child div to the center */  background-color: White; /*Background Replace*/  }  .charactersrow{  display: flex;  flex-grow: 1;  flex-direction: column;  justify-content: center; /* here we just put the only child div to the center */  }  .character{  margin: 20px 10px 0 0;  padding: 0px 0px 14px 0px;  display: flex;  flex-wrap: wrap;  justify-content: center; /* here we just put the only child div to the center */  border-radius: 0.5px;  border-color: grey;  border-style: solid;  position: relative;  }  .character2{  margin: 10px 10px 0 0;  padding: 0px 0px;  height: 220px;  display: flex;  flex-wrap: nowrap;  justify-content: center; /* here we just put the only child div to the center */  border-radius: 0.5px;  border-color: grey;  border-style: solid;  position: relative;  }  .character2Container{  display: flex;  flex-wrap: wrap;  justify-content: center; /* here we just put the only child div to the center */  }  .character span {  position: absolute;  background-color: grey;  color: White;  width: 100%;  }  .character2 span {  position: absolute;  background-color: grey;  color: White;  width: 100%;  }  .characterImagesOutfit{  height: 200px;  position: relative;  padding-top: 20px;  left: 0px;  }  .characterImagesOutfitA{  position: absolute;  padding-top: 20px;  left: 0px;  }  .characterposename{  position: absolute;  left: 50%;  transform: translate(-50%, -21%);  z-index: 31;  background-color: grey;  color: White;  width: 100%;  }  #ToggleText{  /*Stolen From W3*/  width: 160px;  position: fixed;  top: 10px;  right: 12px;  font-size: 24px;  display: none;  }  .popup{  background-color: #555;  color: #fff;  text-align: center;  border-radius: 6px;  padding: 8px 0;  margin-left: -80px;  z-index: 1;  }  #HelpText{  position: absolute;  top: 7%;  width: 450px;  padding: 10px 15px;  padding-bottom: 15px;  margin-left: auto;  margin-right: auto;  left: 0;  right: 0;  visibility: hidden;  z-index: 32;  }  #HelpTitle{  font-size: 24px;  display: block;  }  .HelpLine{  display: block;  }  #backbutton{  display: inline-block;  vertical-align: sub;  padding-right: 3px;  }  #title{  display: inline-block;  }  </style>  </head>  <body>  <span id="ToggleText" class="popup"></span  ><span id="HelpText" class="popup"  ><span id="HelpTitle">Character Viewer Shortcuts</span> <br>  <span class="HelpLine">Pipe | BackSlash: Disable and enable these shortcuts.</span><br><span  class="HelpLine"  >UpArrow: Return to this page from any page.</span  >  <br><span class="HelpLine">Backspace: Return to previous page. This shortcut will always be enabled.</span  ><br><span class="HelpLine">Left/Right Arrow: Navigate through characters in alphabetical order.</span  ><br><span class="HelpLine" id="PoseHelp"  >Equals/Minus: Increase or decrease how many poses a character must have to be shown.</span  ><br><span class="HelpLine" id="OutfitHelp"  >Enter: Toggle outfit view. This view shows all the outfits for a character. Current status:</span  ></span  ><a id="backbutton">Back</a>  <h1 id="title" onmouseover="popouthelp()" onmouseout="hidehelp()">Text</h1>  <div id="imageList" class="characterswrap"></div>  <div id="imageList2"></div>  <script>  /* jshint esversion: 11, -W083*/ function popouthelp() {  var popup=document.getElementById("HelpText");  popup.style.visibility="visible";  }  function hidehelp() {  var popup=document.getElementById("HelpText");  popup.style.visibility="hidden";  }  function parseTextBool(textToParse) {  return textToParse=="true" ? true : false;  }  function getTextWidth(text, font) {  const canvas=getTextWidth.canvas || (getTextWidth.canvas=document.createElement("canvas"));  const context=canvas.getContext("2d");  context.font=font;  const metrics=context.measureText(text);  return metrics.width;  }  function compareDefaultAcc(a, b) {  a=parseInt(a[1]);  b=parseInt(b[1]);  if (a < b) {  return -1;  }  if (a > b) {  return 1;  }  return 0;  }  function loadImages(extra_path, index_start, sources, callback) {  var images={};  var loadedImages=0;  var numImages=0;  for (var _ in sources) {  numImages++;  }  for (var src in sources) {  images[src]=new Image();  images[src].onload=function () {  if (++loadedImages >= numImages) {  callback(images);  }  };  if (src >= index_start) {  images[src].src=extra_path + sources[src];  } else {  images[src].src=sources[src];  }  }  }  function makeCharURL(namepose, urlToMend) {  var splitted=namepose.toString().split(",");  urlToMend.searchParams.set("character", splitted[0]);  urlToMend.searchParams.set("pose", splitted[1]);  }  function getLayeringOrderOutfits(out_start, outfit, outfits) {  var default_outfit=[].concat(out_start + outfit);  if (outfits.length > 0) {  var negativeOffset=0;  outfits.sort(compareDefaultAcc);  for (var src in outfits) {  outfits[src][0]=out_start + outfits[src][0];  if (parseInt(outfits[src][1]) < 0) {  default_outfit.splice(negativeOffset, 0, [].concat(outfits[src][0], outfits[src][2]));  negativeOffset++;  } else {  default_outfit.push([].concat(outfits[src][0], outfits[src][2]));  }  }  }  return default_outfit;  }  function getLayeringOrder(out_start, outfit, character_obj) {  var default_outfit=[].concat(out_start + outfit);  if (character_obj.default_accessories.length > 0) {  var negativeOffset=0;  character_obj.default_accessories.sort(compareDefaultAcc);  for (var src in character_obj.default_accessories) {  character_obj.default_accessories[src][0] =  out_start + character_obj.default_accessories[src][0];  if (parseInt(character_obj.default_accessories[src][1]) < 0) {  default_outfit.splice(  negativeOffset,  0,  [].concat(  character_obj.default_accessories[src][0],  character_obj.default_accessories[src][2]  )  );  negativeOffset++;  } else {  default_outfit.push(  [].concat(  character_obj.default_accessories[src][0],  character_obj.default_accessories[src][2]  )  );  }  }  }  return default_outfit;  }  function getLayeringOrderFlat(out_start, outfit, character_obj) {  var default_outfit=getLayeringOrder(out_start, outfit, character_obj);  for (var i=0; i < default_outfit.length; i++) {  if (Array.isArray(default_outfit[i])) {  default_outfit[i]=default_outfit[i][0];  }  }  return default_outfit;  }  String.prototype.rsplit=function (sep, maxsplit=0) {  var split=this.split(sep);  return maxsplit ? [split.slice(0, -maxsplit).join(sep)].concat(split.slice(-maxsplit)) : split;  };  var disable_keys=parseTextBool(sessionStorage.getItem("disable_keys"));  if (disable_keys==false) {  sessionStorage.setItem("disable_keys", false);  disable_keys=false;  }  $("#ToggleText").text(  disable_keys ? "Keyboard shortcuts are disabled." : "Keyboard shortcuts are enabled."  );  var scenario="Class Swap";var characterArray=[['amaria', 'a', 2], ['amaria', 'b', 2], ['brenda', 'a', 2], ['brenda', 'b', 2], ['cornelia', 'a', 2], ['cornelia', 'b', 2], ['erica', 'a', 3], ['erica', 'b', 3], ['erica', 'c', 3], ['iroha', 'a', 2], ['iroha', 'b', 2], ['izuna', 'a', 5], ['izuna', 'aears', 5], ['izuna', 'b', 5], ['izuna', 'bears', 5], ['izuna', 'sword', 5], ['marin', 'a', 3], ['marin', 'b', 3], ['marin', 'c', 3], ['phila', 'a', 2], ['phila', 'b', 2], ['sadie', 'a', 1], ['tori', 'a', 2], ['tori', 'b', 2], ['watson', 'a', 2], ['watson', 'b', 2]]; var jsonData={ "amaria": {"name": "amaria", "poses" :{"a" : {"max_face_height": 205, "face_path": "characters/amaria/a/faces/face/", "faces": ['0.png', '1.png'], "outfit_path": "characters/amaria/a/outfits/", "default_outfit" : "uniform/uniform.png", "default_accessories" : [ ["uniform/hair+1/off.png", "+1", 111],   ], "default_left_crop" : 170, "default_right_crop" : 446,"default_top_crop" : 28, "outfits": ["casual/casual.png", "casual/casual2.png", "gym/gym.png", "nude/nude.png", "uniform/uniform.png"]}, "b" : {"max_face_height": 205, "face_path": "characters/amaria/b/faces/face/", "faces": ['0.png', '1.png'], "outfit_path": "characters/amaria/b/outfits/", "default_outfit" : "uniform/uniform.png", "default_accessories" : [ ["uniform/hair+1/off.png", "+1", 111],   ], "default_left_crop" : 255, "default_right_crop" : 446,"default_top_crop" : 28, "outfits": ["casual/casual.png", "casual_book/casual_book.png", "gym/gym.png", "nude/nude.png", "uniform/uniform.png"]}, }},"brenda": {"name": "brenda", "poses" :{"a" : {"max_face_height": 261, "face_path": "characters/brenda/a/faces/face/", "faces": ['0.webp', '1.webp', '2.webp', '3.webp', '4.webp', '5.webp', '6.webp', '7.webp'], "outfit_path": "characters/brenda/a/outfits/", "default_outfit" : "uniform.webp", "default_accessories" : [   ], "default_left_crop" : 166, "default_right_crop" : 389,"default_top_crop" : 54, "outfits": ["dress.webp", "gothloli.webp", "suit.webp", "uniform.webp"]}, "b" : {"max_face_height": 270, "face_path": "characters/brenda/b/faces/face/", "faces": ['0.webp', '1.webp', '2.webp', '3.webp', '4.webp', '5.webp', '6.webp'], "outfit_path": "characters/brenda/b/outfits/", "default_outfit" : "uniform.webp", "default_accessories" : [   ], "default_left_crop" : 183, "default_right_crop" : 439,"default_top_crop" : 62, "outfits": ["dress.webp", "gothloli.webp", "suit.webp", "uniform.webp"]}, }},"cornelia": {"name": "cornelia", "poses" :{"a" : {"max_face_height": 201, "face_path": "characters/cornelia/a/faces/face/", "faces": ['0.webp', '1.webp', '2.webp', '3.webp', '4.webp', '5.webp', '6.webp', '7.webp', '8.webp', '9.webp', '10.webp', '11.webp', '12.webp', '13.webp', '14.webp', '15.webp', '16.webp', '17.webp', '18.webp', '19.webp', '20.webp', '21.webp', '22.webp'], "outfit_path": "characters/cornelia/a/outfits/", "default_outfit" : "gym2.webp", "default_accessories" : [   ], "default_left_crop" : 70, "default_right_crop" : 363,"default_top_crop" : 6, "outfits": ["gym.webp", "gym2.webp"]}, "b" : {"max_face_height": 217, "face_path": "characters/cornelia/b/faces/mutations/", "faces": ['twintails/face/0.webp', 'twintails/face/1.webp', 'twintails/face/2.webp', 'twintails/face/3.webp', 'twintails/face/4.webp', 'twintails/face/5.webp', 'twintails/face/6.webp', 'twintails/face/7.webp', 'twintails/face/8.webp', 'twintails/face/9.webp', 'twintails/face/10.webp', 'twintails/face/11.webp', 'twintails/face/12.webp', 'twintails/face/13.webp', 'twintails/face/14.webp', 'twintails/face/15.webp', 'twintails/face/16.webp', 'twintails/face/17.webp', 'twintails/face/18.webp', 'twintails/face/19.webp', 'twintails/face/20.webp', 'twintails/face/21.webp', 'twintails/face/22.webp', 'twintails/face/23.webp', 'twintails/face/24.webp', 'twintails/face/25.webp', 'twintails/face/26.webp', 'twintails/face/27.webp', 'twintails/face/28.webp', 'twintails/face/29.webp', 'twintails/face/30.webp', 'twintails/face/31.webp', 'twintails/face/32.webp', 'twintails/face/33.webp', 'twintails/face/34.webp'], "outfit_path": "characters/cornelia/b/outfits/", "default_outfit" : "uniform/uniform.webp", "default_accessories" : [ ["uniform/ponytail/off.webp", "0", 200],   ], "default_left_crop" : 14, "default_right_crop" : 425,"default_top_crop" : 14, "outfits": ["uniform/uniform.webp"]}, }},"erica": {"name": "erica", "poses" :{"a" : {"max_face_height": 251, "face_path": "characters/erica/a/faces/face/", "faces": ['0.webp', '1.webp', '2.webp', '3.webp', '4.webp', '5.webp', '6.webp', '7.webp', '8.webp', '9.webp', '10.webp', '11.webp', '12.webp', '13.webp', '14.webp', '15.webp', '16.webp', '17.webp', '18.webp', '19.webp', '20.webp', '21.webp', '22.webp', '23.webp', '24.webp', '25.webp', '26.webp', '27.webp'], "outfit_path": "characters/erica/a/outfits/", "default_outfit" : "uniform/uniform.webp", "default_accessories" : [   ], "default_left_crop" : 100, "default_right_crop" : 329,"default_top_crop" : 0, "outfits": ["casual/casual.webp", "gown/gown.webp", "kimono/kimono.webp", "traditional/traditional.webp", "uniform/uniform.webp", "uniform_b/uniform_b.webp", "uniform_c/uniform_c.webp"]}, "b" : {"max_face_height": 243, "face_path": "characters/erica/b/faces/face/", "faces": ['0.webp', '1.webp', '2.webp', '3.webp', '4.webp', '5.webp', '6.webp', '7.webp', '8.webp', '9.webp', '10.webp', '11.webp', '12.webp', '13.webp', '14.webp', '15.webp', '16.webp', '17.webp', '18.webp', '19.webp', '20.webp', '21.webp', '22.webp', '23.webp', '24.webp', '25.webp', '26.webp', '27.webp'], "outfit_path": "characters/erica/b/outfits/", "default_outfit" : "uniform.webp", "default_accessories" : [   ], "default_left_crop" : 71, "default_right_crop" : 326,"default_top_crop" : 0, "outfits": ["casual.webp", "gown.webp", "kimono.webp", "traditional.webp", "uniform.webp", "uniform_b.webp", "uniform_c.webp"]}, "c" : {"max_face_height": 240, "face_path": "characters/erica/c/faces/face/", "faces": ['0.webp', '1.webp', '2.webp', '3.webp', '4.webp', '5.webp', '6.webp', '7.webp', '8.webp', '9.webp', '10.webp', '11.webp', '12.webp', '13.webp', '14.webp', '15.webp', '16.webp', '17.webp', '18.webp', '19.webp', '20.webp', '21.webp', '22.webp', '23.webp', '24.webp', '25.webp', '26.webp', '27.webp'], "outfit_path": "characters/erica/c/outfits/", "default_outfit" : "casual.webp", "default_accessories" : [   ], "default_left_crop" : 140, "default_right_crop" : 431,"default_top_crop" : 6, "outfits": ["casual.webp", "gown.webp", "kimono.webp", "traditional.webp", "uniform_c.webp"]}, }},"iroha": {"name": "iroha", "poses" :{"a" : {"max_face_height": 211, "face_path": "characters/iroha/a/faces/face/", "faces": ['0.webp', '1.webp', '2.webp', '3.webp', '4.webp', '5.webp', '6.webp', '7.webp'], "outfit_path": "characters/iroha/a/outfits/", "default_outfit" : "uniform.webp", "default_accessories" : [   ], "default_left_crop" : 105, "default_right_crop" : 327,"default_top_crop" : 31, "outfits": ["casual.webp", "maid.webp", "uniform.webp", "uniform_b.webp"]}, "b" : {"max_face_height": 215, "face_path": "characters/iroha/b/faces/face/", "faces": ['0.webp', '1.webp', '2.webp', '3.webp', '4.webp', '5.webp', '6.webp', '7.webp'], "outfit_path": "characters/iroha/b/outfits/", "default_outfit" : "uniform.webp", "default_accessories" : [   ], "default_left_crop" : 182, "default_right_crop" : 407,"default_top_crop" : 28, "outfits": ["casual.webp", "maid.webp", "uniform.webp", "uniform_b.webp"]}, }},"izuna": {"name": "izuna", "poses" :{"a" : {"max_face_height": 220, "face_path": "characters/izuna/a/faces/face/", "faces": ['0.webp', '1.webp', '2.webp', '3.webp', '4.webp', '5.webp', '6.webp', '7.webp', '8.webp'], "outfit_path": "characters/izuna/a/outfits/", "default_outfit" : "uniform.webp", "default_accessories" : [   ], "default_left_crop" : 222, "default_right_crop" : 482,"default_top_crop" : 26, "outfits": ["casual.webp", "casualb.webp", "casualbb.webp", "gym.webp", "uniform.webp", "uniforms.webp", "uniformsnoband.webp"]}, "aears" : {"max_face_height": 220, "face_path": "characters/izuna/aears/faces/face/", "faces": ['0.webp', '1.webp', '2.webp', '3.webp', '4.webp', '5.webp', '6.webp', '7.webp', '8.webp'], "outfit_path": "characters/izuna/aears/outfits/", "default_outfit" : "casualb.webp", "default_accessories" : [   ], "default_left_crop" : 210, "default_right_crop" : 483,"default_top_crop" : 15, "outfits": ["casualb.webp", "casualbb.webp"]}, "b" : {"max_face_height": 210, "face_path": "characters/izuna/b/faces/face/", "faces": ['0.webp', '1.webp', '2.webp', '3.webp', '4.webp', '5.webp'], "outfit_path": "characters/izuna/b/outfits/", "default_outfit" : "uniform.webp", "default_accessories" : [   ], "default_left_crop" : 204, "default_right_crop" : 461,"default_top_crop" : 14, "outfits": ["casual.webp", "casualb.webp", "uniform.webp"]}, "bears" : {"max_face_height": 210, "face_path": "characters/izuna/bears/faces/face/", "faces": ['0.webp', '1.webp', '2.webp', '3.webp', '4.webp', '5.webp'], "outfit_path": "characters/izuna/bears/outfits/", "default_outfit" : "casualb.webp", "default_accessories" : [   ], "default_left_crop" : 204, "default_right_crop" : 461,"default_top_crop" : 14, "outfits": ["casualb.webp"]}, "sword" : {"max_face_height": 220, "face_path": "characters/izuna/sword/faces/face/", "faces": ['0.webp', '1.webp', '2.webp', '3.webp', '4.webp', '5.webp'], "outfit_path": "characters/izuna/sword/outfits/", "default_outfit" : "uniform.webp", "default_accessories" : [   ], "default_left_crop" : 210, "default_right_crop" : 483,"default_top_crop" : 15, "outfits": ["uniform.webp"]}, }},"marin": {"name": "marin", "poses" :{"a" : {"max_face_height": 456, "face_path": "characters/marin/a/faces/face/", "faces": ['0.webp', '1.webp', '2.webp', '3.webp', '4.webp', '5.webp', '6.webp', '7.webp', '8.webp', '9.webp', '10.webp', '11.webp', '12.webp', '13.webp', '14.webp', '15.webp', '16.webp'], "outfit_path": "characters/marin/a/outfits/", "default_outfit" : "casual.webp", "default_accessories" : [   ], "default_left_crop" : 162, "default_right_crop" : 543,"default_top_crop" : 126, "outfits": ["bathrobe.webp", "casual.webp", "fashion.webp", "magical.webp", "pj.webp", "swimsuit2.webp"]}, "b" : {"max_face_height": 456, "face_path": "characters/marin/b/faces/face/", "faces": ['0.webp', '1.webp', '2.webp', '3.webp', '4.webp', '5.webp', '6.webp', '7.webp', '8.webp', '9.webp', '10.webp', '11.webp', '12.webp', '13.webp', '14.webp', '15.webp', '16.webp'], "outfit_path": "characters/marin/b/outfits/", "default_outfit" : "casual.webp", "default_accessories" : [   ], "default_left_crop" : 162, "default_right_crop" : 543,"default_top_crop" : 126, "outfits": ["casual.webp", "fashion.webp", "magical.webp", "pj.webp", "swimsuit2.webp"]}, "c" : {"max_face_height": 456, "face_path": "characters/marin/c/faces/face/", "faces": ['0.webp', '1.webp', '2.webp', '3.webp', '4.webp', '5.webp', '6.webp', '7.webp', '8.webp', '9.webp', '10.webp', '11.webp', '12.webp', '13.webp', '14.webp', '15.webp', '16.webp'], "outfit_path": "characters/marin/c/outfits/", "default_outfit" : "casual.webp", "default_accessories" : [   ], "default_left_crop" : 162, "default_right_crop" : 543,"default_top_crop" : 126, "outfits": ["casual.webp", "fashion.webp", "magical.webp", "pj.webp", "swimsuit2.webp"]}, }},"phila": {"name": "phila", "poses" :{"a" : {"max_face_height": 171, "face_path": "characters/phila/a/faces/face/", "faces": ['0.webp', '1.webp', '2.webp', '3.webp', '4.webp', '5.webp', '6.webp', '7.webp', '8.webp', '9.webp'], "outfit_path": "characters/phila/a/outfits/", "default_outfit" : "uniform.webp", "default_accessories" : [   ], "default_left_crop" : 26, "default_right_crop" : 292,"default_top_crop" : 0, "outfits": ["dress.webp", "swimsuit.webp", "uniform.webp"]}, "b" : {"max_face_height": 171, "face_path": "characters/phila/b/faces/face/", "faces": ['0.webp', '1.webp', '2.webp', '3.webp', '4.webp', '5.webp', '6.webp', '7.webp', '8.webp'], "outfit_path": "characters/phila/b/outfits/", "default_outfit" : "uniform.webp", "default_accessories" : [   ], "default_left_crop" : 91, "default_right_crop" : 306,"default_top_crop" : 5, "outfits": ["dress.webp", "gym.webp", "uniform.webp"]}, }},"sadie": {"name": "sadie", "poses" :{"a" : {"max_face_height": 269, "face_path": "characters/sadie/a/faces/face/", "faces": ['0.webp', '1.webp', '2.webp', '3.webp', '4.webp', '5.webp', '6.webp', '7.webp', '8.webp', '9.webp', '10.webp', '11.webp', '12.webp', '13.webp', '14.webp', '15.webp', '16.webp', '17.webp', '18.webp', '19.webp', '20.webp', '21.webp', '22.webp', '23.webp', '24.webp', '25.webp', '26.webp', '27.webp', '28.webp', '29.webp', '30.webp', '31.webp', '32.webp'], "outfit_path": "characters/sadie/a/outfits/", "default_outfit" : "uniform/uniform.webp", "default_accessories" : [ ["uniform/hairdown/off.webp", "0", 200],   ], "default_left_crop" : 0, "default_right_crop" : 428,"default_top_crop" : 0, "outfits": ["casual/casual.webp", "casual_b/casual_b.webp", "casual_madie/casual.webp", "casual_madie_b/casual_b.webp", "cheer.webp", "cheer_inverted.webp", "cheer_madie.webp", "cheer_madie_inverted.webp", "sleepwear/sleepwear.webp", "sleepwear_madie/sleepwear.webp", "uniform/uniform.webp", "uniform_madie/uniform_madie.webp"]}, }},"tori": {"name": "tori", "poses" :{"a" : {"max_face_height": 236, "face_path": "characters/tori/a/faces/face/", "faces": ['0.webp', '1.webp', '2.webp', '3.webp', '4.webp', '5.webp', '6.webp', '7.webp', '8.webp', '9.webp', '10.webp', '11.webp', '12.webp', '13.webp', '14.webp', '15.webp'], "outfit_path": "characters/tori/a/outfits/", "default_outfit" : "uniform.webp", "default_accessories" : [   ], "default_left_crop" : 95, "default_right_crop" : 306,"default_top_crop" : 0, "outfits": ["casual.webp", "fancy.webp", "gym.webp", "uniform.webp"]}, "b" : {"max_face_height": 238, "face_path": "characters/tori/b/faces/face/", "faces": ['0.webp', '1.webp', '2.webp', '3.webp', '4.webp', '5.webp', '6.webp', '7.webp', '8.webp', '9.webp', '10.webp', '11.webp', '12.webp', '13.webp'], "outfit_path": "characters/tori/b/outfits/", "default_outfit" : "uniform.webp", "default_accessories" : [   ], "default_left_crop" : 95, "default_right_crop" : 417,"default_top_crop" : 17, "outfits": ["casual.webp", "formal.webp", "swimsuit.webp", "uniform.webp"]}, }},"watson": {"name": "watson", "poses" :{"a" : {"max_face_height": 250, "face_path": "characters/watson/a/faces/face/", "faces": ['0.webp', '1.webp', '2.webp', '3.webp', '4.webp', '5.webp', '6.webp'], "outfit_path": "characters/watson/a/outfits/", "default_outfit" : "coat.webp", "default_accessories" : [   ], "default_left_crop" : 156, "default_right_crop" : 373,"default_top_crop" : 2, "outfits": ["coat.webp", "coat_glasses.webp"]}, "b" : {"max_face_height": 789, "face_path": "characters/watson/b/faces/face/", "faces": ['0.webp'], "outfit_path": "characters/watson/b/outfits/", "default_outfit" : "mask.webp", "default_accessories" : [   ], "default_left_crop" : 77, "default_right_crop" : 609,"default_top_crop" : 1, "outfits": ["mask.webp"]}, }},}; $("#backbutton").empty();  indexLen=characterArray.length - 1;  file_name=location.pathname.split("/").pop() || ".";  var max_poses=Math.max(...characterArray.map((o) => o[2]));  var static_url_addons="";  function* enumerate(it, start=0) {  let i=start;  for (const x of it) yield [i++, x];  }  const urlParams=new URLSearchParams(window.location.search);  var newURL=new URL(location.protocol + "//" + location.host + location.pathname);  var homeURL=new URL(location.protocol + "//" + location.host + location.pathname);  var pose_filter =  urlParams.get("pcount") && /^\d+$/.test(urlParams.get("pcount"))  ? parseInt(urlParams.get("pcount"))  : 1;  if (pose_filter > max_poses) {  pose_filter=max_poses;  }  var outfit_filter=urlParams.get("outfitview") && /^[1]$/.test(urlParams.get("outfitview")) ? true : false;  if (outfit_filter) {  newURL.searchParams.set("outfitview", "1");  homeURL.searchParams.set("outfitview", "1");  document.getElementById("imageList").classList.replace("characterswrap", "charactersrow");  scenario += " Outfit View";  }  if (pose_filter > 1) {  newURL.searchParams.set("pcount", pose_filter);  homeURL.searchParams.set("pcount", pose_filter);  }  document.getElementById("PoseHelp").innerHTML += " Current filter: >=" + pose_filter;  document.getElementById("OutfitHelp").innerHTML += outfit_filter ? "On" : "Off";  var urlIndex=urlParams.get("index");  if (urlIndex > indexLen || urlIndex < 0) {  urlIndex=undefined;  }  var selectedCharacter=urlParams.get("character") ? urlParams.get("character") : undefined;  var selectedPose=urlParams.get("pose") ? urlParams.get("pose") : undefined;  if (selectedCharacter==undefined || selectedPose==undefined || urlIndex != undefined) {  selectedCharacter=undefined;  selectedPose=undefined;  } else if (  selectedCharacter != undefined &&  (!(selectedCharacter in jsonData) || !(selectedPose in jsonData[selectedCharacter].poses))  ) {  selectedCharacter=undefined;  selectedPose=undefined;  } else {  newURL.searchParams.set("character", selectedCharacter);  newURL.searchParams.set("pose", selectedPose);  }  if (urlIndex != undefined) {  selectedCharacter=characterArray[urlIndex][0];  selectedPose=characterArray[urlIndex][1];  newURL.searchParams.set("index", urlIndex);  }  window.history.replaceState(scenario, scenario, newURL.toString());  var rect_height=32;  if (selectedCharacter==undefined) {  title.textContent=scenario;  var url2=new URL(newURL.toString());  Object.entries(jsonData).forEach(([character, characterData]) => {  if (pose_filter > 1 && Object.keys(characterData.poses).length < pose_filter) {  return;  }  url2.searchParams.set("character", character);  var html="";  charElement=document.createElement("div");  if (outfit_filter) {  Object.entries(characterData.poses).forEach(([pose, poseData]) => {  var outfits=poseData.outfits.map((outfit) => [  outfit[0],  outfit[0].split("/").pop(),  outfit[1],  ]);  url2.searchParams.set("pose", pose);  characterDiv=document.createElement("div");  characterDiv.classList.add("character");  span=document.createElement("span");  span.textContent=character + "_" + pose;  characterDiv.appendChild(span);  for (const outfit of outfits) {  charLink=document.createElement("a");  charLink.href=url2.toString();  characterDiv.appendChild(charLink);  outerDiv=document.createElement("div");  outerDiv.classList.add("outerDiv");  charLink.appendChild(outerDiv);  var default_outfit=getLayeringOrderOutfits(  poseData.outfit_path,  outfit[0],  outfit[2]  );  for (var i of default_outfit) {  img=document.createElement("img");  var image_path;  if (Array.isArray(i)) {  image_path=i[0];  img.style.height=i[1] + "px";  img.classList.add("characterImagesOutfitA");  } else {  image_path=i;  img.classList.add("characterImagesOutfit");  }  img.src=image_path;  img.alt=image_path.rsplit("/")[0].rsplit(".")[0];  outerDiv.appendChild(img);  }  nameDiv=document.createElement("div");  nameDiv.classList.add("characterposename");  nameDiv.textContent=outfit[1].rsplit(".")[0];  outerDiv.appendChild(nameDiv);  }  charElement.appendChild(characterDiv);  });  $("#imageList").append(charElement);  } else {  characterDiv=document.createElement("div");  characterDiv.classList.add("character");  span=document.createElement("span");  span.textContent=character;  characterDiv.appendChild(span);  Object.entries(characterData.poses).forEach(([pose, poseData]) => {  url2.searchParams.set("pose", pose);  var outfitPath=poseData.outfit_path + poseData.default_outfit;  var default_outfit=getLayeringOrder(  poseData.outfit_path,  poseData.default_outfit,  poseData  );  charLink=document.createElement("a");  charLink.href=url2.toString();  characterDiv.appendChild(charLink);  outerDiv=document.createElement("div");  outerDiv.classList.add("outerDiv");  charLink.appendChild(outerDiv);  for (var i of default_outfit) {  img=document.createElement("img");  var image_path;  if (Array.isArray(i)) {  image_path=i[0];  img.style.height=i[1] + "px";  img.classList.add("characterImagesOutfitA");  } else {  image_path=i;  img.classList.add("characterImagesOutfit");  }  img.src=image_path;  img.alt=image_path.rsplit("/")[0].rsplit(".")[0];  outerDiv.appendChild(img);  }  nameDiv=document.createElement("div");  nameDiv.classList.add("characterposename");  nameDiv.textContent=pose;  outerDiv.appendChild(nameDiv);  });  charElement.appendChild(characterDiv);  $("#imageList").append(charElement);  }  });  } else {  var character=jsonData[selectedCharacter];  const out_start=character.poses[selectedPose].outfit_path;  title.textContent=selectedCharacter + "_" + selectedPose;  $("#backbutton").append(  "<img src='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAA4UlEQVR42mNgGAWjgAKQnZlZk5WV0TBwlmdm/AdjejsiKyMjB245vR0BtLwCaOFvNAd8z8pK9xgYn4McQ0fLR6LPszISsPj8c1ZWms1AWT6QPk9/P5A+pyrGV8Kl0NpyvA4ABvN6WluO1wENDQ0swGw3f8AcAAOZmRmzsWi8nZaWJkK3SgeHI+5nZGQo0K/my8zsxuaIrKwslYENiYyMx4MhJJ7npKeb0DEk0psxHZH+PictTYOeITF9wEMC1PxCdwQwdPrp2i4EWYiUIOeDCjC6t4zBIZGVMXlALB8FwwYAANeQ3GvAWTt8AAAAAElFTkSuQmCC' style='height: 25px;width: auto;padding-top: 10px;'>"  );  $("#backbutton").attr("href", homeURL.toString());  characterContainer=document.createElement("div");  characterContainer.classList.add("character2Container");  var html="<div class='character2Container'>";  let outfits=Object.keys(character.poses[selectedPose].outfits);  Object.entries(character.poses[selectedPose].outfits).forEach(([index, outfit]) => {  var outfitName=outfit[0].split("/").pop();  var default_outfit=getLayeringOrderOutfits(out_start, outfit[0], outfit[1]);  var char2=document.createElement("div");  char2.classList.add("character2");  char2.style.minWidth=getTextWidth(outfitName, '16px "Times New Roman"') + 5 + "px";  for (var i of default_outfit) {  img=document.createElement("img");  var image_path;  if (Array.isArray(i)) {  image_path=i[0];  img.style.height=i[1] + "px";  img.classList.add("characterImagesOutfitA");  } else {  image_path=i;  img.classList.add("characterImagesOutfit");  }  img.src=image_path;  img.alt=image_path.rsplit("/")[0].rsplit(".")[0];  char2.appendChild(img);  }  outName=document.createElement("span");  outName.textContent=outfit[0].split("/").pop().rsplit(".")[0];  char2.appendChild(outName);  characterContainer.appendChild(char2);  });  $("#imageList").append(characterContainer);  newCanvas=document.createElement("canvas");  newCanvas.id="canvas";  $("#imageList2").append(newCanvas);  html="";  var face_path=character.poses[selectedPose].face_path;  var total_images=character.poses[selectedPose].faces.length;  var columns=parseInt(Math.sqrt(total_images));  var rows=parseInt(Math.ceil(total_images / columns));  const image_padding=10;  var canvas=document.getElementById("canvas");  var default_outfit=getLayeringOrderFlat(  out_start,  character.poses[selectedPose].default_outfit,  character.poses[selectedPose]  );  const skip_num=default_outfit.length;  character.poses[selectedPose].faces=default_outfit.concat(character.poses[selectedPose].faces);  var context=canvas.getContext("2d");  var left_crop=character.poses[selectedPose].default_left_crop;  var right_crop=character.poses[selectedPose].default_right_crop;  var top_crop=character.poses[selectedPose].default_top_crop;  var nheight=parseInt(character.poses[selectedPose].max_face_height - top_crop + rect_height);  var nwidth=right_crop - left_crop;  canvas.height=(nheight + image_padding) * rows;  canvas.width=nwidth * columns;  loadImages(face_path, skip_num, character.poses[selectedPose].faces, function (images) {  var current_column=0;  var swidth=0;  var sheight=0;  for (const [index, element] of enumerate(character.poses[selectedPose].faces)) {  if (index < skip_num) {  continue;  }  if (index % 2==1) {  context.fillStyle="Black"; /*Color1 replace*/  } else {  context.fillStyle="#121212"; /*Color2 replace*/  }  context.fillRect(swidth, sheight, nwidth, nheight + image_padding);  for (var i=0; i < skip_num; i++) {  context.drawImage(  images[i],  left_crop,  top_crop,  nwidth,  nheight,  swidth,  sheight,  nwidth,  nheight  );  }  context.drawImage(  images[index],  left_crop,  top_crop,  nwidth,  nheight,  swidth,  sheight,  nwidth,  nheight  );  context.font="24pt Calibri";  txt_str=selectedPose + "_" + element.split("/").pop().split(".")[0].replace("%23", "#");  context.fillStyle="White"; /*rect color*/ context.fillRect(  swidth,  sheight + nheight - rect_height,  nwidth,  rect_height + image_padding  );  context.fillStyle="Black"; /*text color*/ context.fillText(  txt_str,  (nwidth - getTextWidth(txt_str, context.font)) / 2 + swidth,  sheight + nheight - (rect_height - image_padding) / 2 / 2  );  swidth += nwidth;  current_column++;  if (current_column >= columns) {  sheight += nheight + image_padding;  swidth=0;  current_column=0;  }  }  });  document.title=scenario + " " + selectedCharacter + "_" + selectedPose;  }  $("body").bind("keydown", function (event) {  var char_index;  var replaceUrl;  if (event.key=="Backspace" && selectedCharacter != undefined) {  history.back();  } else if (event.code=="Backslash") {  disable_keys=!disable_keys;  sessionStorage.setItem("disable_keys", disable_keys);  $("#ToggleText").finish();  $("#ToggleText")  .text(disable_keys ? "Keyboard shortcuts are disabled." : "Keyboard shortcuts are enabled.")  .fadeIn(1250)  .delay(3000)  .fadeOut(2000);  } else if (disable_keys) {  } else if (event.key=="ArrowUp" && selectedCharacter != undefined) {  window.location.href=homeURL.toString();  } else if (event.key=="ArrowRight") {  if (selectedCharacter != undefined && urlIndex==undefined) {  newIndex=characterArray.findIndex((element) =>  element.toString().includes([selectedCharacter, selectedPose].toString())  );  do {  newIndex=newIndex==indexLen ? 0 : newIndex + 1;  } while (pose_filter > 1 && characterArray[newIndex][2] < pose_filter);  makeCharURL(characterArray[newIndex], newURL);  window.location.href=newURL.toString();  } else if (urlIndex==undefined) {  char_index=0;  while (pose_filter > 1 && characterArray[char_index][2] < pose_filter) {  char_index++;  }  newURL.searchParams.set("index", char_index);  window.location.href=newURL.toString();  } else {  do {  urlIndex=urlIndex - 1 + 2 > indexLen ? 0 : urlIndex - 1 + 2;  } while (pose_filter > 1 && characterArray[urlIndex][2] < pose_filter);  newURL.searchParams.set("index", urlIndex);  window.location.href=newURL.toString();  }  } else if (event.key=="ArrowLeft") {  if (selectedCharacter != undefined && urlIndex==undefined) {  newIndex=characterArray.findIndex((element) =>  element.toString().includes([selectedCharacter, selectedPose].toString())  );  do {  newIndex=newIndex==0 ? indexLen : newIndex - 1;  } while (pose_filter > 1 && characterArray[newIndex][2] < pose_filter);  makeCharURL(characterArray[newIndex], newURL);  window.location.href=newURL.toString();  } else if (urlIndex==undefined) {  char_index=indexLen;  while (pose_filter > 1 && characterArray[char_index][2] < pose_filter) {  char_index--;  }  newURL.searchParams.set("index", char_index);  window.location.href=newURL.toString();  } else {  do {  urlIndex=urlIndex - 1 < 0 ? indexLen : urlIndex - 1;  } while (pose_filter > 1 && characterArray[urlIndex][2] < pose_filter);  newURL.searchParams.set("index", urlIndex);  window.location.href=newURL.toString();  }  } else if (event.code=="Minus") {  old_pose_filter=pose_filter;  pose_filter=pose_filter - 1 < 1 ? 1 : pose_filter - 1;  newURL.searchParams.set("pcount", pose_filter);  if (old_pose_filter==pose_filter) {  return;  } else if (title.textContent==scenario) {  window.location.href=newURL.toString();  } else {  replaceUrl=new URL(window.location.href);  if (static_url_addons.includes("pcount")) {  static_url_addons=static_url_addons.replace(  "pcount=" + old_pose_filter,  "pcount=" + pose_filter  );  } else {  static_url_addons=static_url_addons + "&pcount=" + pose_filter;  }  if (pose_filter != old_pose_filter) {  p_help=document.getElementById("PoseHelp");  p_help.textContent=p_help.textContent.replace(">=" + old_pose_filter, ">=" + pose_filter);  }  replaceUrl.searchParams.set("pcount", pose_filter);  window.history.replaceState(scenario, scenario, replaceUrl.toString());  }  } else if (event.code=="Equal") {  old_pose_filter=pose_filter;  pose_filter=pose_filter + 1 > max_poses ? max_poses : pose_filter + 1;  newURL.searchParams.set("pcount", pose_filter);  if (old_pose_filter==pose_filter) {  return;  } else if (title.textContent==scenario) {  window.location.href=newURL.toString();  } else {  replaceUrl=new URL(window.location.href);  if (static_url_addons.includes("pcount")) {  static_url_addons=static_url_addons.replace(  "pcount=" + old_pose_filter,  "pcount=" + pose_filter  );  } else {  static_url_addons=static_url_addons + "&pcount=" + pose_filter;  }  if (pose_filter != old_pose_filter) {  p_help=document.getElementById("PoseHelp");  p_help.textContent=p_help.textContent.replace(">=" + old_pose_filter, ">=" + pose_filter);  }  replaceUrl.searchParams.set("pcount", pose_filter);  window.history.replaceState(scenario, scenario, replaceUrl.toString());  }  } else if (event.code=="Enter") {  old_outfit_filter=outfit_filter ? 1 : 0;  old_outfit_word=outfit_filter ? "On" : "Off";  outfit_filter=!outfit_filter;  new_outfit_filter=outfit_filter ? 1 : 0;  new_outfit_word=outfit_filter ? "On" : "Off";  newURL.searchParams.set("outfitview", new_outfit_filter);  if (title.textContent==scenario) {  window.location.href=newURL.toString();  } else {  replaceUrl=new URL(window.location.href);  if (static_url_addons.includes("outfitview")) {  static_url_addons=static_url_addons.replace(  "outfitview=" + old_outfit_filter,  "outfitview=" + new_outfit_filter  );  } else {  static_url_addons=static_url_addons + "&outfitview=" + new_outfit_filter;  }  o_help=document.getElementById("OutfitHelp");  o_help.textContent=o_help.textContent.replace(  "Current status: " + old_outfit_word,  "Current status: " + new_outfit_word  );  replaceUrl.searchParams.set("outfitview", new_outfit_filter);  window.history.replaceState(scenario, scenario, replaceUrl.toString());  }  }  });  </script>  </body>  </html> 