<!DOCTYPE html><html> <head> <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no"/> <title>Class Swap Viewer</title> <script src="https://code.jquery.com/jquery-3.5.0.js"></script> <style>body{text-align: center; background-color: white; /*Background Replace*/}#canvas{padding-top: 10px;}.characters{display: flex; flex-wrap: wrap; justify-content: center; /* here we just put the only child div to the center */}.character{margin: 10px 10px 0 0; padding: 0px 0px; height: 238px; display: flex; flex-wrap: nowrap; justify-content: center; /* here we just put the only child div to the center */ border-radius: 0.5px; border-color: grey; border-style: solid; position: relative;}.character2{margin: 10px 10px 0 0; padding: 0px 0px; height: 220px; display: flex; flex-wrap: nowrap; justify-content: center; /* here we just put the only child div to the center */ border-radius: 0.5px; border-color: grey; border-style: solid; position: relative;}.character2Container{display: flex; flex-wrap: wrap; justify-content: center; /* here we just put the only child div to the center */}.character span{position: absolute; background-color: grey; color: white; width: 100%;}.character2 span{position: absolute; background-color: grey; color: white; width: 100%;}.characterImagesOutfit{height: 200px; position: relative; top: 20px; left: 0px;}.characterposename{position: absolute; left: 50%; top: 100%; transform: translate(-50%, 0%); z-index: 31; background-color: grey; color: white; margin-top: 16px; width: 100%;}#ToggleText{/*Stolen From W3*/ width: 160px; position: fixed; top: 10px; right: 12px; font-size: 24px; display: none;}.popup{background-color: #555; color: #fff; text-align: center; border-radius: 6px; padding: 8px 0; margin-left: -80px; z-index: 1;}#HelpText{position: absolute; top: 7%; width: 450px; padding: 10px 15px; padding-bottom: 15px; margin-left: auto; margin-right: auto; left: 0; right: 0; visibility: hidden;}#HelpTitle{font-size: 24px; display: block;}.HelpLine{display: block;}#backbutton{display: inline-block; vertical-align: sub; padding-right: 3px;}#title{display: inline-block;}</style> </head> <body> <span id="ToggleText" class="popup"></span> <span id="HelpText" class="popup" ><span id="HelpTitle">Character Viewer Shortcuts</span> <br/><span class="HelpLine" >Pipe | BackSlash: Disable and enable these shortcuts</span > <br/><span class="HelpLine" >UpArrow: Return to this page from any page</span > <br/><span class="HelpLine" >Backspace: Return to previous page</span > <br/><span class="HelpLine" >Left/Right Arrow: Navigate through characters in alphabetical order</span > </span> <a id="backbutton"></a> <h1 id="title" onmouseover="popouthelp()" onmouseout="hidehelp()" ></h1> <div id="imageList" class="characters"></div><div id="imageList2"></div></body> <script type="text/javascript">function popouthelp(){var popup=document.getElementById("HelpText"); popup.style.visibility="visible";}function hidehelp(){var popup=document.getElementById("HelpText"); popup.style.visibility="hidden";}function parseTextBool(textToParse){return textToParse=="true" ? true : false;}function getTextWidth(text, font){const canvas=getTextWidth.canvas || (getTextWidth.canvas=document.createElement("canvas")); const context=canvas.getContext("2d"); context.font=font; const metrics=context.measureText(text); return metrics.width;}function loadImages(extra_path, index_start, sources, callback){var images={}; var loadedImages=0; var numImages=0; for (var src in sources){numImages++;}for (var src in sources){images[src]=new Image(); images[src].onload=function (){if (++loadedImages >=numImages){callback(images);}}; if (src >=index_start){images[src].src=extra_path + sources[src];}else{images[src].src=sources[src];}}}function makeCharURL(namepose){var splitted=namepose.toString().split(","); return "character=" + splitted[0] + "&pose=" + splitted[1];}var disable_keys=parseTextBool( sessionStorage.getItem("disable_keys") ); if (disable_keys==false){sessionStorage.setItem("disable_keys", false); disable_keys=false;}$("#ToggleText").text( disable_keys ? "Keyboard shortcuts are disabled." : "Keyboard shortcuts are enabled." ); var scenario="Class Swap"; var testArray=[['brenda', 'a'], ['brenda', 'b'], ['erica', 'a'], ['erica', 'b'], ['erica', 'c'], ['iroha', 'a'], ['iroha', 'b'], ['izuna', 'a'], ['izuna', 'aears'], ['izuna', 'b'], ['izuna', 'bears'], ['izuna', 'sword'], ['marin', 'a'], ['marin', 'b'], ['marin', 'c'], ['phila', 'a'], ['phila', 'b'], ['sadie', 'a'], ['tori', 'a'], ['tori', 'b'], ['watson', 'a'], ['watson', 'b']]; var jsonData={ "brenda": {"name": "brenda", "poses" :{"a" : {"max_face_height": 261, "faces": ['0.webp', '1.webp', '2.webp', '3.webp', '4.webp', '5.webp', '6.webp', '7.webp'], "default_outfit" : "uniform.webp", "default_accessories" : [   ], "default_left_crop" : 166, "default_right_crop" : 389,"default_top_crop" : 54, "outfits": ["dress.webp", "gothloli.webp", "suit.webp", "uniform.webp"]}, "b" : {"max_face_height": 270, "faces": ['0.webp', '1.webp', '2.webp', '3.webp', '4.webp', '5.webp', '6.webp'], "default_outfit" : "uniform.webp", "default_accessories" : [   ], "default_left_crop" : 183, "default_right_crop" : 439,"default_top_crop" : 62, "outfits": ["dress.webp", "gothloli.webp", "suit.webp", "uniform.webp"]}, }},"erica": {"name": "erica", "poses" :{"a" : {"max_face_height": 251, "faces": ['0.webp', '1.webp', '2.webp', '3.webp', '4.webp', '5.webp', '6.webp', '7.webp', '8.webp', '9.webp', '10.webp', '11.webp', '12.webp', '13.webp', '14.webp', '15.webp', '16.webp', '17.webp', '18.webp', '19.webp', '20.webp', '21.webp', '22.webp', '23.webp', '24.webp', '25.webp', '26.webp', '27.webp'], "default_outfit" : "uniform/uniform.png", "default_accessories" : [   ], "default_left_crop" : 100, "default_right_crop" : 329,"default_top_crop" : 0, "outfits": ["casual/casual.webp", "gown/gown.webp", "kimono/kimono.webp", "traditional/traditional.webp", "uniform/uniform.png", "uniform_b/uniform_b.png", "uniform_c/uniform_c.webp"]}, "b" : {"max_face_height": 243, "faces": ['0.webp', '1.webp', '2.webp', '3.webp', '4.webp', '5.webp', '6.webp', '7.webp', '8.webp', '9.webp', '10.webp', '11.webp', '12.webp', '13.webp', '14.webp', '15.webp', '16.webp', '17.webp', '18.webp', '19.webp', '20.webp', '21.webp', '22.webp', '23.webp', '24.webp', '25.webp', '26.webp', '27.webp'], "default_outfit" : "uniform.png", "default_accessories" : [   ], "default_left_crop" : 71, "default_right_crop" : 326,"default_top_crop" : 0, "outfits": ["casual.webp", "gown.webp", "kimono.webp", "traditional.webp", "uniform.png", "uniform_b.png", "uniform_c.webp"]}, "c" : {"max_face_height": 240, "faces": ['0.webp', '1.webp', '2.webp', '3.webp', '4.webp', '5.webp', '6.webp', '7.webp', '8.webp', '9.webp', '10.webp', '11.webp', '12.webp', '13.webp', '14.webp', '15.webp', '16.webp', '17.webp', '18.webp', '19.webp', '20.webp', '21.webp', '22.webp', '23.webp', '24.webp', '25.webp', '26.webp', '27.webp'], "default_outfit" : "casual.webp", "default_accessories" : [   ], "default_left_crop" : 140, "default_right_crop" : 431,"default_top_crop" : 6, "outfits": ["casual.webp", "gown.webp", "kimono.webp", "traditional.webp", "uniform_c.webp"]}, }},"iroha": {"name": "iroha", "poses" :{"a" : {"max_face_height": 211, "faces": ['0.webp', '1.webp', '2.webp', '3.webp', '4.webp', '5.webp', '6.webp', '7.webp'], "default_outfit" : "uniform.webp", "default_accessories" : [   ], "default_left_crop" : 105, "default_right_crop" : 327,"default_top_crop" : 31, "outfits": ["casual.webp", "maid.webp", "uniform.webp", "uniform_b.png"]}, "b" : {"max_face_height": 215, "faces": ['0.webp', '1.webp', '2.webp', '3.webp', '4.webp', '5.webp', '6.webp', '7.webp'], "default_outfit" : "uniform.webp", "default_accessories" : [   ], "default_left_crop" : 182, "default_right_crop" : 407,"default_top_crop" : 28, "outfits": ["casual.webp", "maid.webp", "uniform.webp", "uniform_b.png"]}, }},"izuna": {"name": "izuna", "poses" :{"a" : {"max_face_height": 220, "faces": ['0.png', '1.png', '2.png', '3.png', '4.png', '5.png', '6.png', '7.png', '8.png'], "default_outfit" : "uniform.webp", "default_accessories" : [   ], "default_left_crop" : 222, "default_right_crop" : 482,"default_top_crop" : 26, "outfits": ["casual.webp", "casualb.webp", "casualbb.webp", "gym.webp", "uniform.webp", "uniforms.webp", "uniformsnoband.webp"]}, "aears" : {"max_face_height": 220, "faces": ['0.png', '1.png', '2.png', '3.png', '4.png', '5.png', '6.png', '7.png', '8.png'], "default_outfit" : "casualb.webp", "default_accessories" : [   ], "default_left_crop" : 210, "default_right_crop" : 483,"default_top_crop" : 15, "outfits": ["casualb.webp", "casualbb.webp"]}, "b" : {"max_face_height": 210, "faces": ['0.webp', '1.webp', '2.webp', '3.webp', '4.webp', '5.webp'], "default_outfit" : "uniform.webp", "default_accessories" : [   ], "default_left_crop" : 204, "default_right_crop" : 461,"default_top_crop" : 14, "outfits": ["casual.webp", "casualb.webp", "uniform.webp"]}, "bears" : {"max_face_height": 210, "faces": ['0.webp', '1.webp', '2.webp', '3.webp', '4.webp', '5.webp'], "default_outfit" : "casualb.webp", "default_accessories" : [   ], "default_left_crop" : 204, "default_right_crop" : 461,"default_top_crop" : 14, "outfits": ["casualb.webp"]}, "sword" : {"max_face_height": 220, "faces": ['0.webp', '1.webp', '2.webp', '3.webp', '4.webp', '5.webp'], "default_outfit" : "uniform.webp", "default_accessories" : [   ], "default_left_crop" : 210, "default_right_crop" : 483,"default_top_crop" : 15, "outfits": ["uniform.webp"]}, }},"marin": {"name": "marin", "poses" :{"a" : {"max_face_height": 456, "faces": ['0.png', '1.png', '2.png', '3.png', '4.png', '5.png', '6.png', '7.png', '8.png', '9.png', '10.png', '11.png', '12.png', '13.png', '14.png', '15.png', '16.png'], "default_outfit" : "casual.png", "default_accessories" : [   ], "default_left_crop" : 162, "default_right_crop" : 543,"default_top_crop" : 126, "outfits": ["bathrobe.png", "casual.png", "fashion.png", "magical.png", "pj.png", "swimsuit2.png"]}, "b" : {"max_face_height": 456, "faces": ['0.png', '1.png', '2.png', '3.png', '4.png', '5.png', '6.png', '7.png', '8.png', '9.png', '10.png', '11.png', '12.png', '13.png', '14.png', '15.png', '16.png'], "default_outfit" : "casual.png", "default_accessories" : [   ], "default_left_crop" : 162, "default_right_crop" : 543,"default_top_crop" : 126, "outfits": ["casual.png", "fashion.png", "magical.png", "pj.png", "swimsuit2.png"]}, "c" : {"max_face_height": 456, "faces": ['0.png', '1.png', '2.png', '3.png', '4.png', '5.png', '6.png', '7.png', '8.png', '9.png', '10.png', '11.png', '12.png', '13.png', '14.png', '15.png', '16.png'], "default_outfit" : "casual.png", "default_accessories" : [   ], "default_left_crop" : 162, "default_right_crop" : 543,"default_top_crop" : 126, "outfits": ["casual.png", "fashion.png", "magical.png", "pj.png", "swimsuit2.png"]}, }},"phila": {"name": "phila", "poses" :{"a" : {"max_face_height": 171, "faces": ['0.png', '1.png', '2.png', '3.png', '4.png', '5.png', '6.png', '7.png', '8.png', '9.png'], "default_outfit" : "uniform.png", "default_accessories" : [   ], "default_left_crop" : 26, "default_right_crop" : 292,"default_top_crop" : 0, "outfits": ["dress.png", "swimsuit.png", "uniform.png"]}, "b" : {"max_face_height": 171, "faces": ['0.png', '1.png', '2.png', '3.png', '4.png', '5.png', '6.png', '7.png', '8.png'], "default_outfit" : "uniform.png", "default_accessories" : [   ], "default_left_crop" : 91, "default_right_crop" : 306,"default_top_crop" : 5, "outfits": ["dress.png", "gym.png", "uniform.png"]}, }},"sadie": {"name": "sadie", "poses" :{"a" : {"max_face_height": 269, "faces": ['0.png', '1.png', '2.png', '3.png', '4.png', '5.png', '6.png', '7.png', '8.png', '9.png', '10.png', '11.png', '12.png', '13.png', '14.png', '15.png', '16.png', '17.png', '18.png', '19.png', '20.png', '21.png', '22.png', '23.png', '24.png', '25.png', '26.png', '27.png', '28.png', '29.png', '30.png', '31.png', '32.png'], "default_outfit" : "uniform/uniform.webp", "default_accessories" : [ "uniform/hairdown/off.webp",   ], "default_left_crop" : 66, "default_right_crop" : 428,"default_top_crop" : 21, "outfits": ["casual/casual.webp", "casual_b/casual_b.webp", "casual_madie/casual.webp", "casual_madie_b/casual_b.webp", "cheer.webp", "cheer_inverted.webp", "cheer_madie.webp", "cheer_madie_inverted.webp", "sleepwear/sleepwear.webp", "sleepwear_madie/sleepwear.webp", "uniform/uniform.webp", "uniform_madie/uniform_madie.webp"]}, }},"tori": {"name": "tori", "poses" :{"a" : {"max_face_height": 236, "faces": ['0.png', '1.png', '2.png', '3.png', '4.png', '5.png', '6.png', '7.png', '8.png', '9.png', '10.png', '11.png', '12.png', '13.png', '14.png', '15.png'], "default_outfit" : "uniform.png", "default_accessories" : [   ], "default_left_crop" : 95, "default_right_crop" : 306,"default_top_crop" : 0, "outfits": ["casual.png", "fancy.png", "gym.png", "uniform.png"]}, "b" : {"max_face_height": 238, "faces": ['0.png', '1.png', '2.png', '3.png', '4.png', '5.png', '6.png', '7.png', '8.png', '9.png', '10.png', '11.png', '12.png', '13.png'], "default_outfit" : "uniform.png", "default_accessories" : [   ], "default_left_crop" : 95, "default_right_crop" : 417,"default_top_crop" : 17, "outfits": ["casual.png", "formal.png", "swimsuit.png", "uniform.png"]}, }},"watson": {"name": "watson", "poses" :{"a" : {"max_face_height": 250, "faces": ['0.png', '1.png', '2.png', '3.png', '4.png', '5.png', '6.png'], "default_outfit" : "coat.png", "default_accessories" : [   ], "default_left_crop" : 156, "default_right_crop" : 373,"default_top_crop" : 2, "outfits": ["coat.png", "coat_glasses.png"]}, "b" : {"max_face_height": 789, "faces": ['0.png'], "default_outfit" : "mask.png", "default_accessories" : [   ], "default_left_crop" : 77, "default_right_crop" : 609,"default_top_crop" : 1, "outfits": ["mask.png"]}, }},}; indexLen=testArray.length - 1; file_name=location.pathname.split("/").pop() || "."; function* enumerate(it, start=0){let i=start; for (const x of it) yield [i++, x];}const urlParams=new URLSearchParams(window.location.search); var urlIndex=urlParams.get("index"); if (urlIndex > indexLen || urlIndex < 0){urlIndex=undefined;}var selectedCharacter=urlParams.get("character") ? urlParams.get("character") : undefined; var selectedPose=urlParams.get("pose") ? urlParams.get("pose") : undefined; var new_url=file_name + "?"; if ( selectedCharacter==undefined || selectedPose==undefined || urlIndex !=undefined ){selectedCharacter=undefined; selectedPose=undefined;}else if ( selectedCharacter !=undefined && (!(selectedCharacter in jsonData) || !(selectedPose in jsonData[selectedCharacter].poses)) ){selectedCharacter=undefined; selectedPose=undefined;}else{new_url +="character=" + selectedCharacter + "&pose=" + selectedPose;}if (urlIndex !=undefined){selectedCharacter=testArray[urlIndex][0]; selectedPose=testArray[urlIndex][1]; new_url +="index=" + urlIndex;}window.history.pushState(scenario, scenario, new_url); var rect_height=32; if (selectedCharacter==undefined){title.textContent=scenario; Object.entries(jsonData).forEach(([character, characterData])=>{var html="<div class='character'><span>" + character + "</span>"; Object.entries(characterData.poses).forEach( ([pose, poseData])=>{var outfitPath="characters/" + character + "/" + pose + "/outfits/" + poseData.default_outfit; html +="<a href='" + file_name + "?character=" + character + "&pose=" + pose + "'><div style='position:relative;text-align:center'><img class='characterImagesOutfit' src='" + outfitPath + "'/><div class='characterposename'>" + pose + "</div></div></a>";}); html +="</div>"; $("#imageList").append(html); window.history.pushState(scenario, scenario, file_name);});}else{var character=jsonData[selectedCharacter]; const out_start="characters/" + selectedCharacter + "/" + selectedPose + "/outfits/"; title.textContent=selectedCharacter + "_" + selectedPose; $("#backbutton").append("<img src='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAA4UlEQVR42mNgGAWjgAKQnZlZk5WV0TBwlmdm/AdjejsiKyMjB245vR0BtLwCaOFvNAd8z8pK9xgYn4McQ0fLR6LPszISsPj8c1ZWms1AWT6QPk9/P5A+pyrGV8Kl0NpyvA4ABvN6WluO1wENDQ0swGw3f8AcAAOZmRmzsWi8nZaWJkK3SgeHI+5nZGQo0K/my8zsxuaIrKwslYENiYyMx4MhJJ7npKeb0DEk0psxHZH+PictTYOeITF9wEMC1PxCdwQwdPrp2i4EWYiUIOeDCjC6t4zBIZGVMXlALB8FwwYAANeQ3GvAWTt8AAAAAElFTkSuQmCC' style='height: 25px;width: auto;padding-top: 10px;'>"); $("#backbutton").attr("href",file_name); var html="<div class='character2Container'>"; let outfits=Object.keys(character.poses[selectedPose].outfits); Object.entries(character.poses[selectedPose].outfits).forEach( ([index, outfit])=>{var outfitPath=out_start + outfit; var outfitName=outfit.split("/").pop(); html +="<div class='character2' style='min-width:" + (getTextWidth(outfitName, '16px "Times New Roman"') + 5) + "px;'><img class='characterImagesOutfit' src='" + outfitPath + "'/><span>" + outfit.split("/").pop() + "</span></div>";}); html +="</div>"; $("#imageList").append(html); html=""; var face_path="characters/" + selectedCharacter + "/" + selectedPose + "/faces/face/"; var total_images=character["poses"][selectedPose]["faces"]; var columns=parseInt(Math.sqrt(total_images.length)); var rows=parseInt(Math.ceil(total_images.length / columns)); const image_padding=10; html +="<canvas id='canvas'/><canvas>"; $("#imageList2").append(html); var canvas=document.getElementById("canvas"); var default_outfit=[].concat( out_start + character.poses[selectedPose].default_outfit ); if (character.poses[selectedPose].default_accessories.length > 0){for (src in character.poses[selectedPose].default_accessories){character.poses[selectedPose].default_accessories[src]=out_start + character.poses[selectedPose].default_accessories[src];}default_outfit=default_outfit.concat( character.poses[selectedPose].default_accessories );}const skip_num=default_outfit.length; character.poses[selectedPose].faces=default_outfit.concat( character.poses[selectedPose].faces ); var context=canvas.getContext("2d"); var left_crop=character.poses[selectedPose].default_left_crop; var right_crop=character.poses[selectedPose].default_right_crop; var top_crop=character.poses[selectedPose].default_top_crop; var nheight=parseInt( character.poses[selectedPose].max_face_height - top_crop + rect_height ); var nwidth=right_crop - left_crop; canvas.height=(nheight + image_padding) * rows; canvas.width=nwidth * columns; loadImages( face_path, skip_num, character.poses[selectedPose].faces, function (images){var current_column=0; var swidth=0; var sheight=0; for (const [index, element] of enumerate( character.poses[selectedPose].faces )){if (index < skip_num){continue;}if (index % 2==1){context.fillStyle="Black";}else{context.fillStyle="#121212";}context.fillRect( swidth, sheight, nwidth, nheight + image_padding ); for (var i=0; i < skip_num; i++){context.drawImage( images[i], left_crop, top_crop, nwidth, nheight, swidth, sheight, nwidth, nheight );}context.drawImage( images[index], left_crop, top_crop, nwidth, nheight, swidth, sheight, nwidth, nheight ); context.font="24pt Calibri"; txt_str=selectedPose + "_" + element .split("/") .pop() .split(".")[0] .replace("%23", "#"); context.fillStyle="white"; /*rect color*/ context.fillRect( swidth, sheight + nheight - rect_height, nwidth, rect_height + image_padding ); context.fillStyle="black"; /*text color*/ context.fillText( txt_str, (nwidth - getTextWidth(txt_str, context.font)) / 2 + swidth, sheight + nheight - (rect_height - image_padding) / 2 / 2 ); swidth +=nwidth; current_column++; if (current_column >=columns){sheight +=nheight + image_padding; swidth=0; current_column=0;}}}); html=""; $("#imageList2").append(html); document.title=scenario + " " + selectedCharacter + "_" + selectedPose;}$("body").bind("keydown", function (event){if (event.key=="Backspace" && selectedCharacter !=undefined){history.back();}else if (event.code=="Backslash"){disable_keys=!disable_keys; sessionStorage.setItem("disable_keys", disable_keys); $("#ToggleText").finish(); $("#ToggleText") .text( disable_keys ? "Keyboard shortcuts are disabled." : "Keyboard shortcuts are enabled." ) .fadeIn(1250) .delay(3000) .fadeOut(2000);}else if (disable_keys){}else if (event.key=="ArrowUp"){window.location.href=file_name;}else if (event.key=="ArrowRight"){if (selectedCharacter !=undefined && urlIndex==undefined){testIndex=testArray.findIndex( (element)=> element.toString()==[selectedCharacter, selectedPose].toString() ); testIndex=testIndex==indexLen ? 0 : testIndex + 1; window.location.href=file_name + "?" + makeCharURL(testArray[testIndex]);}else if (urlIndex==undefined){window.location.href=file_name + "?index=0";}else{window.location.href=file_name + "?index=" + (urlIndex - 1 + 2 > indexLen ? 0 : urlIndex - 1 + 2);}}else if (event.key=="ArrowLeft"){if (selectedCharacter !=undefined && urlIndex==undefined){testIndex=testArray.findIndex( (element)=> element.toString()==[selectedCharacter, selectedPose].toString() ); testIndex=testIndex==0 ? indexLen : testIndex - 1; window.location.href=file_name + "?" + makeCharURL(testArray[testIndex]);}else if (urlIndex==undefined){window.location.href=file_name + "?index=0";}else{window.location.href=file_name + "?index=" + (urlIndex - 1 < 0 ? indexLen : urlIndex - 1);}}}); </script></html>